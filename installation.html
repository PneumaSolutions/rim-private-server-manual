<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Installation - Remote Incident Manager Private Server Manual</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="welcome.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item expanded "><a href="systemspecs.html"><strong aria-hidden="true">2.</strong> System Requirements</a></li><li class="chapter-item expanded "><a href="installation.html" class="active"><strong aria-hidden="true">3.</strong> Installation</a></li><li class="chapter-item expanded "><a href="First-Time-Setup.html"><strong aria-hidden="true">4.</strong> First-Time Setup</a></li><li class="chapter-item expanded "><a href="dashboard.html"><strong aria-hidden="true">5.</strong> Dashboard</a></li><li class="chapter-item expanded "><a href="troubleshooting.html"><strong aria-hidden="true">6.</strong> Troubleshooting</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Remote Incident Manager Private Server Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>The Remote Incident Manager server is packaged as a stand-alone Windows application. While the below process assumes the presence of a Windows Server environment, the instructions will be more or less the same for a standard Windows 10 or 11 environment.</p>
<h2 id="setup-process"><a class="header" href="#setup-process">Setup Process</a></h2>
<p>The RIM server application is packaged as a self-contained MSI package. This server can be installed as the only resident server application on the machine, or work alongside any existing infrastructure through a reverse proxy. We will document the general process for setting up a reverse proxy through Internet Information Services (IIS). Unless otherwise noted, we will avoid specific mentions of the graphical user interface of IIS throughout these instructions. This will allow you to apply these instructions to whichever configuration method (GUI, CLI or web-based admin tool) you use throughout your organization.</p>
<h3 id="prerequisits"><a class="header" href="#prerequisits">Prerequisits</a></h3>
<p>Before installing the RIM server, it is strongly recommended to have a fully configured IIS infrastructure along with all related packages. In addition, the <a href="https://aka.ms/vs/17/release/vc_redist.x64.exe">Microsoft Visual C++ Redistributables</a> are required for the RIM server to function.</p>
<h4 id="installing-iis-and-additional-modules"><a class="header" href="#installing-iis-and-additional-modules">Installing IIS and Additional Modules</a></h4>
<ol>
<li>Install the IIS role onto your server. In addition to the web management tools, http server, etc. make sure that the web sockets protocol module is queued for installation.</li>
<li>Install the <a href="https://www.iis.net/downloads/microsoft/application-request-routing">Application Request Routing (AAR)</a> module, which will allow IIS to function as a reverse proxy.</li>
<li>Lastly, install the <a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite</a> module.</li>
</ol>
<!-- end -->
<p>Now that we have IIS installed, configuration of the reverse proxy can begin.</p>
<h4 id="enabling-the-proxy-within-aar"><a class="header" href="#enabling-the-proxy-within-aar">Enabling the Proxy within AAR</a></h4>
<p>In the main server node, you will find an Application Request Routing Cache configuration. A Server Proxy Settings node is contained within. This is where you will go to enable the proxy function.</p>
<h4 id="ssl-configuration"><a class="header" href="#ssl-configuration">SSL Configuration</a></h4>
<p>RIM does not manage the SSL certificate when running in reverse proxy mode. Instead, you will need to configure the SSL binding and associated certificate for your site in IIS. This can be done either on the default site, or by creating a new website. Be sure to enable https enforce once the ssl binding is configured.</p>
<h4 id="configuring-the-url-rewrite-rules"><a class="header" href="#configuring-the-url-rewrite-rules">Configuring the URL Rewrite Rules</a></h4>
<p>The best way to configure URL rewrite is through a web.config file. In order for this to work, however, you must first add the <code>HTTP_X_FORWARDED_PROTO</code> variable to your server's allowed variables. Then, create a file in your webroot called web.config, and paste the following content:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
    &lt;system.webServer&gt;
        &lt;rewrite&gt;
            &lt;rules&gt;
                &lt;rule name=&quot;ReverseProxyInboundRule1&quot; stopProcessing=&quot;true&quot;&gt;
                    &lt;match url=&quot;(.*)&quot; /&gt;
                    &lt;action type=&quot;Rewrite&quot; url=&quot;http://localhost:7460/{R:1}&quot; /&gt;
                    &lt;serverVariables&gt;
                        &lt;set name=&quot;HTTP_X_FORWARDED_PROTO&quot; value=&quot;https&quot; /&gt;
                    &lt;/serverVariables&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
            &lt;outboundRules&gt;
                &lt;rule name=&quot;ReverseProxyOutboundRule1&quot; preCondition=&quot;ResponseIsHtml1&quot;&gt;
                    &lt;match filterByTags=&quot;A, Form, Img&quot; pattern=&quot;^http(s)?://localhost:7460/(.*)&quot; /&gt;
                    &lt;action type=&quot;Rewrite&quot; value=&quot;http{R:1}://domain.tld/{R:2}&quot; /&gt;
                &lt;/rule&gt;

                &lt;preConditions&gt;
                    &lt;preCondition name=&quot;ResponseIsHtml1&quot;&gt;
                        &lt;add input=&quot;{RESPONSE_CONTENT_TYPE}&quot; pattern=&quot;^text/html&quot; /&gt;
                    &lt;/preCondition&gt;
                &lt;/preConditions&gt;
            &lt;/outboundRules&gt;
        &lt;/rewrite&gt;
        &lt;httpErrors errorMode=&quot;DetailedLocalOnly&quot; /&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;
</code></pre>
<p>Replace domain.tld with your real domain, then save the file. Restart IIS once this file has been saved.</p>
<h3 id="installing-the-rim-server"><a class="header" href="#installing-the-rim-server">Installing the RIM Server</a></h3>
<p>If you have set up a working reverse proxy, now is when you would install the RIM server package. Any references to a reverse proxy can be disregarded if it is not part of your configuration.<br />
The installation is a one-click silent install. Once the installation is finished, the server will start automatically. Note that unless you have set up a reverse proxy as described above, you will need to access the server on port 7460 for initial setup. Additionally, if you intend for your RIM infrastructure to be accessible via the live web, you will need to add your own https firewall rule, as IIS only opens port 80 by default. You do not, however, need to open port 7460.</p>
<h3 id="updating-the-rim-server"><a class="header" href="#updating-the-rim-server">Updating the RIM Server</a></h3>
<p>Updates must be installed manually. Simply download and run the latest msi package when informed of an update.</p>
<h3 id="uninstalling-the-rim-server"><a class="header" href="#uninstalling-the-rim-server">Uninstalling the RIM Server</a></h3>
<p>Uninstalling the RIM server is accomplished via standard means. However, its data folder (which resides in c:\ProgramData) will not be deleted. Should you wish to dispose of the data files, you can do so manually.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="systemspecs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="First-Time-Setup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="systemspecs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="First-Time-Setup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script>
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" charset="utf-8"></script>
        <script src="mark.min.js" charset="utf-8"></script>
        <script src="searcher.js" charset="utf-8"></script>
        <script src="clipboard.min.js" charset="utf-8"></script>
        <script src="highlight.js" charset="utf-8"></script>
        <script src="book.js" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
